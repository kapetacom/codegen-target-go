//#FILENAME:generated/pubsub/subscriber.go:write-always
// GENERATED SOURCE - DO NOT EDIT
package pubsub

import (
    "github.com/kapetacom/sdk-go-config/providers"
    "github.com/kapetacom/sdk-go-google-pubsub/pubsub"
    "{{@root.options.basePackage}}/generated/entities"
    servicepubsub "{{@root.options.basePackage}}/pkg/services/pubsub"
)

{{#consumers-of-type 'kapeta/resource-type-pubsub-subscriber'}}
type {{pascalCase this.metadata.name}}Consumer = pubsub.Consumer[entities.{{this.spec.payloadType.type}}]

type {{pascalCase this.metadata.name}}MessageHandler = pubsub.MessageHandler[entities.{{this.spec.payloadType.type}}, map[string]string]

func Create{{pascalCase this.metadata.name}}Consumer(config providers.ConfigProvider) (*{{pascalCase this.metadata.name}}Consumer, error) {
    consumer, err := servicepubsub.New{{pascalCase this.metadata.name}}Consumer(config)
    if err != nil {
        return nil, err
    }
    return pubsub.CreateConsumer(config, "{{this.metadata.name}}", consumer.OnMessage)
}
{{/consumers-of-type}}
